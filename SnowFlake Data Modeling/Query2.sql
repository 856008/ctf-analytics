[3:38 PM] Mohammed, Omer
CREATE OR REPLACE VIEW PROD_CTF_CLEAN.CTF_CLEAN_T3.DONOR_BY_GENDER_V2
ASSELECT
OP.ID AS ID,
CT.NAME AS NAME,
---OP.ACCOUNTID AS ACCOUNTID,
--AC.NPO02__TOTALOPPAMOUNT__C AS NPO02__TOTALOPPAMOUNT__C,
OP.AMOUNT AS AMOUNT,
-- OP.EXPECTEDREVENUE AS EXPECTEDREVENUE,
-- OP.TOTALOPPORTUNITYQUANTITY AS TOTALOPPORTUNITYQUANTITY,
OP.CLOSEDATE AS CLOSEDATE,
-- OP.CAMPAIGNID AS CAMPAIGNID,
-- OP.CREATEDDATE AS CREATEDDATE,
--OP.FISCALQUARTER AS FISCALQUARTER,
-- OP.FISCALYEAR AS FISCALYEAR,
-- OP.FISCAL AS FISCAL,
SUBSTRING(OP.CLOSEDATE,1,4) AS OPP_CLOSE_YEAR,
-- OP.CONTACTID AS CONTACTID,
CASE WHEN CT.GENDER__C IS NULL THEN 'Unknown'
ELSE CT.GENDER__C END AS GENDER__C,
CT.MARITAL_STATUS__C AS MARITAL_STATUS__C,
CT.SOLICITOR_TYPE__C AS SOLICITOR_TYPE__C,
AC.BILLINGCITY AS BILLINGCITY,
AC.BILLINGSTATE AS BILLINGSTATE,
AC.NPE01__SYSTEM_ACCOUNTTYPE__C AS NPE01__SYSTEM_ACCOUNTTYPE__C,
AC.NPO02__AVERAGEAMOUNT__C AS NPO02__AVERAGEAMOUNT__C,
AC.NPO02__LARGESTAMOUNT__C AS NPO02__LARGESTAMOUNT__C,
AC.NPO02__LASTOPPAMOUNT__C AS NPO02__LASTOPPAMOUNT__C
--AC.NPO02__OPPAMOUNTLASTNDAYS__C AS NPO02__OPPAMOUNTLASTNDAYS__C,
--AC.NPO02__OPPAMOUNTLASTYEAR__C AS NPO02__OPPAMOUNTLASTYEAR__C,
-- AC.NPO02__OPPAMOUNTTHISYEAR__C AS NPO02__OPPAMOUNTTHISYEAR__C,
-- AC.NPO02__SMALLESTAMOUNT__C AS NPO02__SMALLESTAMOUNT__C,
,
--AC.SOLICITOR_TYPE__C AS SOLICITOR_TYPE__C,
AC.DONOR_FREQUENCY_CLASSIFICATION__C AS DONOR_FREQUENCY_CLASSIFICATION__C,
AC.AVERAGE_DONATION_PERIOD__C AS AVERAGE_DONATION_PERIOD__C,
CMP.ULTIMATE_PARENT_CAMPAIGN__C AS ULTIMATE_PARENT_CAMPAIGN_C
FROM "PROD_CTF_RAW"."SRC_SF"."CTF_SF_OPPORTUNITY" OP
INNER JOIN "PROD_CTF_RAW"."SRC_SF"."CTF_SF_CONTACT" CT ON CT.ID = OP.CONTACTID
LEFT JOIN "PROD_CTF_RAW"."SRC_SF"."CTF_SF_ACCOUNT" AC ON AC.ID = OP.ACCOUNTID
LEFT JOIN "PROD_CTF_RAW"."SRC_SF"."CTF_SF_CAMPAIGN" CMP ON OP.CAMPAIGNID = CMP.ID
WHERE OP.TYPE = 'Donation' AND YEAR(CLOSEDATE) >=2016 --AND CT.GENDER__C IS NOT NULL
--ORDER BY NPO02__TOTALOPPAMOUNT__C DESC
--SELECT * FROM "PROD_CTF_CLEAN"."CTF_CLEAN_T3"."DONOR_BY_GENDER_V2"
--WHERE GENDER__C IS NULL;

